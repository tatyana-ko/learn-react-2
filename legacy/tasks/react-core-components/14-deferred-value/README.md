# Оптимизация с useDeferredValue в React

## Теория

`useDeferredValue` - это хук в React, который позволяет отложить обновление менее важной части интерфейса в пользу более важных обновлений:

1. Помогает сохранить отзывчивость UI при тяжелых вычислениях
2. Автоматически определяет приоритеты обновлений
3. Работает как debounce/throttle, но умнее
4. Интегрируется с Concurrent Features в React

## Задача

В этом проекте реализован каталог продуктов с поиском и фильтрацией. Однако есть проблемы с производительностью:

1. UI блокируется при каждом вводе в поиск
2. Тяжелая фильтрация выполняется синхронно
3. Отсутствует индикация загрузки
4. Плохой UX при фильтрации

### Требования

1. Внедрите useDeferredValue для поисковой строки:
   - Отложите тяжелые вычисления
   - Добавьте визуальную индикацию
   - Сохраните отзывчивость UI

2. Оптимизируйте фильтрацию:
   - Используйте useMemo для кеширования
   - Разделите состояние на части
   - Добавьте мемоизацию компонентов

3. Улучшите UX:
   - Добавьте индикаторы загрузки
   - Реализуйте плавные переходы
   - Покажите промежуточные результаты

### Подсказки

1. Используйте useDeferredValue:
   ```typescript
   const SearchResults = ({ searchTerm }) => {
     const deferredTerm = useDeferredValue(searchTerm);
     const isStale = deferredTerm !== searchTerm;
     
     return (
       <div style={{ opacity: isStale ? 0.8 : 1 }}>
         {/* Тяжелые вычисления с deferredTerm */}
       </div>
     );
   };
   ```

2. Комбинируйте с другими хуками:
   ```typescript
   const filteredItems = useMemo(() => {
     return items.filter(item => 
       item.name.includes(deferredTerm)
     );
   }, [items, deferredTerm]);
   ```

3. Добавьте индикацию:
   ```typescript
   const isPending = deferredTerm !== searchTerm;
   
   return (
     <div>
       {isPending && <Spinner />}
       <div style={{ opacity: isPending ? 0.8 : 1 }}>
         {/* Результаты */}
       </div>
     </div>
   );
   ```

## Критерии приемки

1. UI должен оставаться отзывчивым при поиске
2. Должна быть визуальная индикация отложенных обновлений
3. Фильтрация должна работать эффективно
4. Код должен быть чистым и понятным
